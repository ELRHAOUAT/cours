<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devoir nÂ°1 â€“ RÃ©seau Local</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        /* --- NOUVEAU HEADER FORMEL --- */
        .devoir-header {
            background: #ffffff;
            border-radius: 12px;
            padding: 25px 30px;
            margin-bottom: 30px;
            text-align: center;
            border-left: 5px solid #667eea;
            box-shadow: 0 6px 25px rgba(0,0,0,0.1);
        }

        .devoir-header h1 {
            font-size: 28px;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .devoir-header h2 {
            font-size: 20px;
            font-weight: 500;
            color: #555;
            margin-bottom: 10px;
        }

        .devoir-badge {
            font-size: 24px;
            font-weight: 600;
            background: #667eea;
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 3px 8px rgba(102,126,234,0.4);
        }

        /* --- INFO SECTION --- */
        .info-section {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-group {
            display: flex;
            flex-direction: column;
        }

        .info-group label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .info-group input, .info-group select {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        /* --- BOX LISTE ELEVES --- */
        .eleve-box {
            background: #fff;
            border: 2px solid #dcdcdc;
            border-radius: 10px;
            padding: 12px 16px;
            font-size: 15px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .eleve-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
            color: #1a3e85;
            text-align: left;
            direction: ltr;
        }
        
        .eleve-table {
            width: 100%;
            border-collapse: collapse;
            direction: rtl; /* Noms en arabe */
            text-align: right;
        }
        
        .eleve-table td {
            border: 1px solid #e3e3e3;
            padding: 6px 8px;
            vertical-align: top;
            font-size: 14px;
        }

        /* --- CONTENU EXERCICE --- */
        .section h2 {
            color: #667eea;
            font-size: 1.3em;
            margin-bottom: 15px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 8px;
        }

        .context-box {
            background: #f0f4ff;
            border-left: 5px solid #667eea;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            line-height: 1.6;
        }

        .phase {
            background: #f9f9f9;
            border: 2px solid #e0e0e0; /* Plus neutre */
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 18px;
            transition: all 0.3s ease;
        }
        
        .phase:hover {
            border-color: #667eea;
        }

        .phase h4 {
            color: #667eea;
            margin-bottom: 12px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 6px;
        }

        .question-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 12px;
        }

        .question-fr { border-left: 4px solid #667eea; padding-left: 10px; }
        .question-ar { border-right: 4px solid #764ba2; padding-right: 10px; direction: rtl; text-align: right; }

        .options-group { display: flex; flex-direction: column; gap: 8px; }

        .option {
            background: white;
            border: 2px solid #ddd;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option:hover { background: #f0f4ff; border-color: #667eea; }
        
        .option.correct { border-color: #28a745; background: #d4edda; }
        .option.incorrect { border-color: #dc3545; background: #f8d7da; }

        .feedback { display: none; padding: 10px; border-radius: 5px; margin-top: 8px; font-weight: bold; }
        .feedback.show { display: block; }
        .feedback.correct { background: #d4edda; color: #155724; }
        .feedback.incorrect { background: #f8d7da; color: #721c24; }

        /* --- RESULTATS & BOUTONS --- */
        .score-summary {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #667eea;
            display: none;
        }
        .score-summary.show { display: block; }

        .score-note { font-size: 32px; color: #28a745; font-weight: bold; margin-top: 10px; }
        
        .buttons { margin-top: 30px; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        
        .btn {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            font-weight: 600;
            transition: transform 0.2s;
        }
        
        .btn:hover { transform: translateY(-2px); }
        .btn-primary { background: #28a745; }
        .btn-secondary { background: #6c757d; }
        .btn-print { background: #667eea; display: none; } /* CachÃ© par dÃ©faut */

        .warning-alert {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        .warning-alert.show { display: block; }

        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; max-width: 100%; padding: 0; }
            .buttons, .warning-alert { display: none !important; }
            .eleve-box { display: none; } /* On cache la liste des Ã©lÃ¨ves Ã  l'impression */
            .phase { page-break-inside: avoid; border: 1px solid #ccc; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="devoir-header">
        <div class="devoir-badge">Devoir nÂ°1 â€“ Informatique (30 min)</div>
        <h1>Exercice Interactif : Composants Informatiques</h1>
        <h2>CollÃ¨ge Al-Wahda â€“ 2áµ‰ AnnÃ©e</h2>
    </div>

    <div class="info-section">
        <h3 style="margin-bottom: 15px; color: #333;">ğŸ“ Informations personnelles</h3>
        <div class="header-info">
            <div class="info-group">
                <label for="nomComplet">Nom complet / Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                <input type="text" id="nomComplet" placeholder="Ex: Aziz ben Aziz">
            </div>
            <div class="info-group">
                <label for="classe">Classe / Ø§Ù„ÙØµÙ„</label>
                <select id="classe">
                    <option value="">-- SÃ©lectionner --</option>
                    <option value="2APIC-1">2APIC-1</option>
                    <option value="2APIC-2">2APIC-2</option>
                    <option value="2APIC-3">2APIC-3</option>
                    <option value="2APIC-4">2APIC-4</option>
                    <option value="2APIC-5">2APIC-5</option>
                    <option value="2APIC-6">2APIC-6</option>
                    <option value="2APIC-7">2APIC-7</option>
                    <option value="2APIC-8">2APIC-8</option>
                    <option value="2APIC-9">2APIC-9</option>
                </select>
            </div>
            <div class="info-group">
                <label for="groupe">Groupe / Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                <select id="groupe">
                    <option value="G1">G1</option>
                    <option value="G2">G2</option>
                </select>
            </div>
        </div>
        
        <div class="info-group" style="width:100%;">
            <div id="listeElevesBox" class="eleve-box">
                <em>Veuillez choisir une classe pour afficher les Ã©lÃ¨vesâ€¦</em>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“‹ Contexte / Ø§Ù„Ø³ÙŠØ§Ù‚</h2>
        <div class="context-box">
            <strong style="color: #667eea;">Situation :</strong> Au collÃ¨ge Othman Ibn Affane, un nouvel ordinateur n'arrive pas Ã  se connecter Ã  Internet alors que les autres fonctionnent. <strong>Votre mission : Diagnostiquer et rÃ©soudre le problÃ¨me.</strong>
        </div>
        <div class="context-box" style="direction: rtl; text-align: right; border-left: none; border-right: 5px solid #764ba2;">
            <strong style="color: #764ba2;">Ø§Ù„ÙˆØ¶Ø¹ÙŠØ© :</strong> ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†ØŒ Ø­Ø§Ø³ÙˆØ¨ Ø¬Ø¯ÙŠØ¯ Ù„Ø§ ÙŠØªØµÙ„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø¨ÙŠÙ†Ù…Ø§ Ø§Ù„Ø¨Ù‚ÙŠØ© ØªØ¹Ù…Ù„. <strong>Ù…Ù‡Ù…ØªÙƒ: ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„ ÙˆØ¥ØµÙ„Ø§Ø­Ù‡.</strong>
        </div>
    </div>

    <div class="warning-alert" id="warningAlert"></div>

    <div id="questionsContainer">
        <div class="phase">
            <h4>â¶ Question 1 : Type de rÃ©seau</h4>
            <div class="question-header">
                <div class="question-fr">Quel type de rÃ©seau relie les PC de la salle ?</div>
                <div class="question-ar">Ù…Ø§ Ù†ÙˆØ¹ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„ØªÙŠ ØªØ±Ø¨Ø· Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù‚Ø§Ø¹Ø©ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q1" value="a"> <span>Un rÃ©seau local (LAN)</span></label>
                <label class="option"><input type="radio" name="q1" value="b"> <span>Un rÃ©seau international</span></label>
                <label class="option"><input type="radio" name="q1" value="c"> <span>Un rÃ©seau personnel</span></label>
            </div>
            <div id="feedback-q1" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â· Question 2 : Topologie</h4>
            <div class="question-header">
                <div class="question-fr">Quelle est la topologie du rÃ©seau ?</div>
                <div class="question-ar">Ù…Ø§ Ù‡ÙŠ Ø·ÙˆØ¨ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø´Ø¨ÙƒØ©ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q2" value="a"> <span>Topologie en bus</span></label>
                <label class="option"><input type="radio" name="q2" value="b"> <span>Topologie en Ã©toile (Switch)</span></label>
                <label class="option"><input type="radio" name="q2" value="c"> <span>Topologie en anneau</span></label>
            </div>
            <div id="feedback-q2" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â¸ Question 3 : RÃ´le du Switch</h4>
            <div class="question-header">
                <div class="question-fr">Quel est le rÃ´le principal du Switch ?</div>
                <div class="question-ar">Ù…Ø§ Ù‡Ùˆ Ø¯ÙˆØ± Ø§Ù„Ù…Ø¨Ø¯Ù„ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q3" value="a"> <span>Fournir Internet Ã  la maison</span></label>
                <label class="option"><input type="radio" name="q3" value="b"> <span>Relier les ordinateurs entre eux</span></label>
                <label class="option"><input type="radio" name="q3" value="c"> <span>Fournir le Wi-Fi</span></label>
            </div>
            <div id="feedback-q3" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â¹ Question 4 : Connexion</h4>
            <div class="question-header">
                <div class="question-fr">Comment connecter le PC filaire ?</div>
                <div class="question-ar">ÙƒÙŠÙ Ù†Ø±Ø¨Ø· Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ Ø³Ù„ÙƒÙŠØ§Ù‹ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q4" value="a"> <span>CÃ¢ble RJ45 vers carte rÃ©seau</span></label>
                <label class="option"><input type="radio" name="q4" value="b"> <span>Par Wi-Fi uniquement</span></label>
                <label class="option"><input type="radio" name="q4" value="c"> <span>Par Bluetooth</span></label>
            </div>
            <div id="feedback-q4" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>âº Question 5 : Composant essentiel</h4>
            <div class="question-header">
                <div class="question-fr">Que doit possÃ©der le PC pour le filaire ?</div>
                <div class="question-ar">Ù…Ø§Ø°Ø§ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ…Ù„Ùƒ Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ Ù„Ù„Ø±Ø¨Ø· Ø§Ù„Ø³Ù„ÙƒÙŠØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q5" value="a"> <span>Une carte rÃ©seau (Ethernet)</span></label>
                <label class="option"><input type="radio" name="q5" value="b"> <span>Un moniteur</span></label>
                <label class="option"><input type="radio" name="q5" value="c"> <span>Une souris</span></label>
            </div>
            <div id="feedback-q5" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â» Question 6 : CÃ¢ble RJ45</h4>
            <div class="question-header">
                <div class="question-fr">RÃ´le du cÃ¢ble RJ45 ?</div>
                <div class="question-ar">Ø¯ÙˆØ± ÙƒØ§Ø¨Ù„ RJ45ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q6" value="a"> <span>Transporter les donnÃ©es</span></label>
                <label class="option"><input type="radio" name="q6" value="b"> <span>Fournir l'Ã©lectricitÃ©</span></label>
                <label class="option"><input type="radio" name="q6" value="c"> <span>Afficher l'image</span></label>
            </div>
            <div id="feedback-q6" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â¼ Question 7 : VÃ©rification 1</h4>
            <div class="question-header">
                <div class="question-fr">PremiÃ¨re vÃ©rification Ã  faire ?</div>
                <div class="question-ar">Ø£ÙˆÙ„ ÙØ­Øµ ÙŠØ¬Ø¨ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q7" value="a"> <span>VÃ©rifier le branchement du cÃ¢ble</span></label>
                <label class="option"><input type="radio" name="q7" value="b"> <span>Ã‰teindre le PC</span></label>
                <label class="option"><input type="radio" name="q7" value="c"> <span>Acheter un nouveau PC</span></label>
            </div>
            <div id="feedback-q7" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â½ Question 8 : VÃ©rification Switch</h4>
            <div class="question-header">
                <div class="question-fr">Que vÃ©rifier cÃ´tÃ© Switch ?</div>
                <div class="question-ar">Ù…Ø§Ø°Ø§ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¨Ø¯Ù„ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q8" value="a"> <span>CÃ¢ble bien branchÃ© sur un port</span></label>
                <label class="option"><input type="radio" name="q8" value="b"> <span>La couleur du Switch</span></label>
                <label class="option"><input type="radio" name="q8" value="c"> <span>RedÃ©marrer le Switch</span></label>
            </div>
            <div id="feedback-q8" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â¾ Question 9 : Indicateur LED</h4>
            <div class="question-header">
                <div class="question-fr">Signe qu'un port fonctionne ?</div>
                <div class="question-ar">ÙƒÙŠÙ Ù†Ø¹Ø±Ù Ø£Ù† Ø§Ù„Ù…Ù†ÙØ° ÙŠØ¹Ù…Ù„ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q9" value="a"> <span>La LED est allumÃ©e</span></label>
                <label class="option"><input type="radio" name="q9" value="b"> <span>Le Switch fait du bruit</span></label>
                <label class="option"><input type="radio" name="q9" value="c"> <span>Le cÃ¢ble est rouge</span></label>
            </div>
            <div id="feedback-q9" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â¿ Question 10 : LED Ã©teinte</h4>
            <div class="question-header">
                <div class="question-fr">Si la LED est Ã©teinte ?</div>
                <div class="question-ar">Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¶ÙˆØ¡ Ù…Ø·ÙØ£ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q10" value="a"> <span>Pas de connexion (cÃ¢ble HS)</span></label>
                <label class="option"><input type="radio" name="q10" value="b"> <span>Tout va bien</span></label>
                <label class="option"><input type="radio" name="q10" value="c"> <span>RedÃ©marrer Internet</span></label>
            </div>
            <div id="feedback-q10" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â“« Question 11 : Port HS</h4>
            <div class="question-header">
                <div class="question-fr">Si le port ne marche pas ?</div>
                <div class="question-ar">Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ù†ÙØ° Ù„Ø§ ÙŠØ¹Ù…Ù„ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q11" value="a"> <span>Changer de port sur le Switch</span></label>
                <label class="option"><input type="radio" name="q11" value="b"> <span>Acheter un Switch</span></label>
                <label class="option"><input type="radio" name="q11" value="c"> <span>Utiliser le Wi-Fi uniquement</span></label>
            </div>
            <div id="feedback-q11" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â“¬ Question 12 : Alternative</h4>
            <div class="question-header">
                <div class="question-fr">Alternative si Ethernet Ã©choue ?</div>
                <div class="question-ar">Ø§Ù„Ø¨Ø¯ÙŠÙ„ ÙÙŠ Ø­Ø§Ù„ ÙØ´Ù„ Ø§Ù„Ø³Ù„ÙƒØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q12" value="a"> <span>Utiliser le Wi-Fi</span></label>
                <label class="option"><input type="radio" name="q12" value="b"> <span>ArrÃªter Internet</span></label>
                <label class="option"><input type="radio" name="q12" value="c"> <span>Utiliser Bluetooth</span></label>
            </div>
            <div id="feedback-q12" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â“­ Question 13 : Point d'accÃ¨s</h4>
            <div class="question-header">
                <div class="question-fr">Qui fournit le Wi-Fi ?</div>
                <div class="question-ar">Ù…Ù† ÙŠÙˆÙØ± Ø§Ù„Ù€ Wi-FiØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q13" value="a"> <span>Le Switch</span></label>
                <label class="option"><input type="radio" name="q13" value="b"> <span>Le Point d'accÃ¨s (AP)</span></label>
                <label class="option"><input type="radio" name="q13" value="c"> <span>La carte rÃ©seau</span></label>
            </div>
            <div id="feedback-q13" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â“® Question 14 : Routeur</h4>
            <div class="question-header">
                <div class="question-fr">Qui connecte le collÃ¨ge Ã  Internet ?</div>
                <div class="question-ar">Ù…Ù† ÙŠØ±Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†ØªØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q14" value="a"> <span>Le Switch</span></label>
                <label class="option"><input type="radio" name="q14" value="b"> <span>Le Point d'accÃ¨s</span></label>
                <label class="option"><input type="radio" name="q14" value="c"> <span>Le Routeur</span></label>
            </div>
            <div id="feedback-q14" class="feedback"></div>
        </div>

        <div class="phase">
            <h4>â“¯ Question 15 : Test final</h4>
            <div class="question-header">
                <div class="question-fr">Comment valider la rÃ©paration ?</div>
                <div class="question-ar">ÙƒÙŠÙ Ù†ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥ØµÙ„Ø§Ø­ØŸ</div>
            </div>
            <div class="options-group">
                <label class="option"><input type="radio" name="q15" value="a"> <span>Ouvrir un site Web</span></label>
                <label class="option"><input type="radio" name="q15" value="b"> <span>Regarder les cÃ¢bles</span></label>
                <label class="option"><input type="radio" name="q15" value="c"> <span>Attendre</span></label>
            </div>
            <div id="feedback-q15" class="feedback"></div>
        </div>

    </div>

    <div class="score-summary" id="scoreSummary">
        <h3>RÃ©sultats du Devoir</h3>
        <div class="score-note">Note: <span id="noteValue">0</span>/20</div>
        <div id="appreciationBox" style="margin-top:15px; padding:10px; font-weight:bold;"></div>
    </div>

    <div class="buttons">
        <button class="btn btn-primary" onclick="verifierReponses()">âœ“ VÃ©rifier et Envoyer</button>
        <button class="btn btn-secondary" onclick="reinitialiser()">â†» RÃ©initialiser</button>
        <button class="btn btn-print" id="printBtn" onclick="imprimerDevoir()">ğŸ–¨ï¸ TÃ©lÃ©charger le Devoir (PDF)</button>
    </div>

</div>

<form id="saveFormDevoir" action="https://script.google.com/macros/s/AKfycbz5Jvn-ou2LYBudCOegyMI_r70ElCNGyXvhqNYy2G5mOBUBsEw7m_57SCwT7XG0jBle/exec" method="post" target="hidden_iframe_devoir">
    <input type="hidden" name="nom"    id="save_nom">
    <input type="hidden" name="classe" id="save_classe">
    <input type="hidden" name="html"   id="save_html">
</form>
<iframe name="hidden_iframe_devoir" style="display:none;"></iframe>

<script>
    // --- DONNÃ‰ES Ã‰LÃˆVES (Listes fournies) ---
    const ELEVES_2APIC_1 = ["Ø¬Ø±ÙŠØ±ÙŠ Ø§Ù„ÙŠØ§Ø³", "Ø²ÙƒØ§Øº Ø­Ø³Ù†Ø©", "ØµØºÙŠØ±ÙŠ Ø£ÙŠÙ…Ù†", "Ø¨ÙˆØµÙˆÙÙŠ Ø²ÙŠÙ†Ø¨", "Ø§Ù„Ø±Ø§Ø­Ù„ Ø®Ø¯ÙŠØ¬Ø©", "Ø§Ø²Ø¹ÙŠÙ… ÙˆØ§Ø¦Ù„", "Ø§Ù„Ø³Ù‚Ø§Ø± Ø´ÙŠÙ…Ø§Ø¡", "Ø§Ù„ØµØ¨Ø§Ø¨Ø© ÙØ§Ø·Ù…Ø©", "Ù„Ù…Ùˆ Ø£ÙŠÙˆØ¨", "Ø´Ù†ØºØ§Ù Ø³ÙƒÙŠÙ†Ø©", "Ø§Ù…Ù‚Ø±Ø§Ù† ÙŠØ§Ø³ÙŠÙ†", "Ù‚Ù„ÙŠÙ„ Ø¢Ø¯Ù…", "Ø§Ù„Ù‚Ø§ÙŠØ¯ÙŠ Ø³Ù„ÙŠÙ…Ø§Ù†", "Ø§Ù„Ù…Ø¹Ù†Ø§ÙˆÙŠ ÙØ§Ø·Ù…Ø©", "ÙƒÙŠØ±Ø§Ù† Ø³Ù†Ø§Ø¡", "Ø¨ÙˆØ¯Ø®Ø§Ù†Ø© Ø¹Ø«Ù…Ø§Ù†", "Ø£Ø³ÙˆØ§Ù„ ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡", "Ø²ÙƒØ§Øº ÙŠÙ…ÙŠÙ†", "Ø¨ÙˆØ­Ø¯Ø§ÙŠØ¯ Ø£ÙŠÙˆØ¨", "Ø§ÙˆØ¨Ø¶ÙŠÙ„ Ø²ÙŠÙ†Ø¨", "Ø­Ù‚ÙˆÙ†ÙŠ Ø­Ù†Ø§Ù†", "Ø§Ø¹Ø±Ø§Ø¨ ÙØ¯ÙˆÙ‰", "ØµÙÙŠØ§ØªÙŠ Ù…Ø­Ù…Ø¯ Ø£Ù…ÙŠÙ†", "Ø§Ù„Ø²Ø¹ÙŠÙ… ÙƒÙˆØ«Ø±", "Ø§Ù„ÙˆØ±Ø¯ÙŠ Ø¢Ø¯Ù…", "Ù…Ø·Ø¹ÙŠØ´ Ø§Ù…ÙŠÙ…Ø©", "Ø¨ÙˆØ¹ÙˆØ¯Ø© Ù…Ø±ÙŠÙ…", "Ø´Ù„Ø­ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆØ§Ø­Ø¯", "ÙƒØ±Ø§Ø· Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…", "ØªÙƒØ±ÙˆÙ…Øª Ø³Ù„ÙŠÙ…Ø§Ù†", "Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠ ØµÙØ§Ø¡", "Ù…Ø·Ø¹ÙŠØ´ Ù…Ù†Ø¹Ù…", "Ø§Ù„Ø¹Ø±ÙŠØ§Ù†ÙŠ ÙƒØ±ÙŠÙ…Ø©"];
    const ELEVES_2APIC_2 = ["Ø£ÙÙ‚ÙŠØ± ÙŠØ§Ø³Ù…ÙŠÙ†Ø©", "Ø®ØªØ§ Ù…Ø­Ù…Ø¯", "Ø®Ù†ÙˆÙÙŠ Ù…Ø­Ù…Ø¯", "Ø­Ø±Ø¨Ø§Ù„ Ø£Ø³Ø§Ù…Ø©", "Ø§Ø³Ù‚Ø§Ø± Ø³ÙÙŠØ§Ù†", "Ù…Ø±Ø²ÙˆÙ‚ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ø§Ù„ÙƒØ±Ø§Ø±ÙŠ Ø£Ø³Ù…Ø§Ø¡", "Ø²ÙƒØ§Øº Ø§Ø³Ù…Ø§Ø¡", "Ø§ÙƒØ±ÙˆØ± ÙŠØ§Ø³ÙŠÙ†", "Ø§Ù„Ø¹Ø¯ÙˆØªÙŠ ÙÙ‡ÙŠÙ…Ø©", "Ø§Ø´Ø¶Ø§Ù† Ù‡Ø§Ø¬Ø±", "Ø¨Ù†Ø¹Ù„ÙŠ ÙØ§Ø·Ù…Ø©", "Ø§Ù„Ø¹Ù…Ø±Ø§Ù†ÙŠ Ø£Ù…ÙŠÙ…Ø©", "Ø¨ÙˆÙ„Ø¹ÙˆØ§Ù„ÙŠ Ø£Ù†Ø³", "Ø§Ù„Ø²ÙŠØ§Ù†ÙŠ ØµÙØ§Ø¡", "Ø§Ù„Ø­Ù…Ø¯Ø§ØªÙŠ Ø¹Ø«Ù…Ø§Ù†", "Ø§Ù„Ø¯Ø§ÙˆØ¯ÙŠ ÙØ§Ø·Ù…Ø©", "Ø¨Ù„ÙˆØ· Ø§Ø³Ù…Ø§Ø¹ÙŠÙ„", "Ø²ÙƒØ§Øº Ø£Ù…ÙŠÙ†Ø©", "Ø²ÙƒØ§Øº Ù…Ø­Ù…Ø¯ Ø£Ù…ÙŠÙ†", "Ø²ÙƒØ§Øº Ù‡Ø§Ø¬Ø±", "Ø§Ù„Ù‚Ø§ÙŠØ¯ÙŠ ÙˆÙ„ÙŠØ¯", "Ø§Ù„Ø²Ø±ÙˆÙ‚ÙŠ Ù…Ø±ÙˆÙ‰", "Ø¨ÙˆØ­Ø¯Ø§ÙŠØ¯ Ø­Ù„ÙŠÙ…Ø©", "Ø§Ù„Ø¬ØºØ§ÙˆÙŠ Ù…Ø­Ù…Ø¯", "Ø¨ÙˆØ±Ø§Ø± Ø§Ù„Ù‡Ø§Ù…", "Ø§Ù„Ø³Ø¹ÙŠØ¯ÙŠ Ø³Ù„Ù…Ù‰", "Ø¨ÙˆØ¯ÙˆØ­ÙŠ Ø³Ù…Ø§Ø­", "Ø§Ø²Ø¹ÙŠÙ… Ø§ÙŠÙˆØ¨", "Ø§ÙŠØ´Ùˆ Ø¹Ø¯Ù†Ø§Ù†", "Ø§Ù„Ø³Ù‚Ø§Ø± Ø¬ÙˆØ§Ø¯", "Ø§Ù„Ù…Ø³ÙƒÙŠÙ† Ø­Ù…Ø²Ø©", "Ù„ÙƒØ­Ù„ Ø¨Ù„Ø§Ù„"];
    const ELEVES_2APIC_3 = ["Ø§Ù„ØºÙ„Ù…Ø§Ù†ÙŠ Ø²ÙŠØ§Ø¯", "Ø´ÙƒÙˆØ¯ ÙˆØ¦Ø§Ù…", "ØºÙ„Ø§Ø¯Ø© Ø²ÙƒØ§Ø±ÙŠØ§Ø¡", "Ø§Ø¹Ø±Ø§Ø¨ Ø§Ø³Ø§Ù…Ø©", "Ø§Ù„Ø³Ø§Ø¦Ø­ Ø®Ø¯ÙŠØ¬Ø©", "Ù‡Ù†Ø§ØªÙŠ Ø¢Ø¯Ù…", "Ø§Ø¬Ø¶ÙŠØ¶ Ø£Ø³Ø§Ù…Ø©", "Ø§Ù„Ø¬ØºØ§ÙˆÙŠ Ø¢Ø¯Ù…", "Ø§Ù„Ø®Ø¶Ø±Ø§ÙˆÙŠ Ù‡Ù†Ø¯", "Ø§Ù„Ø¹Ø±ÙˆØ³ÙŠ Ù…Ø­Ù…Ø¯", "Ø§Ù„Ø±Ø¯Ø§Ø¯ Ø²ÙƒØ±ÙŠØ§Ø¡", "Ø§Ø¹Ø±Ø§Ø¨ Ù…Ø­Ù…Ø¯", "Ø¨ÙˆÙ„Ø¹ÙˆØ§Ù„ÙŠ Ø²ÙƒØ±ÙŠØ§Ø¡", "Ø¨ÙˆÙ„Ø¹ÙˆØ§Ù„ÙŠ Ø§ÙƒØ±Ø§Ù…", "Ø§Ù„ÙˆÙƒÙŠÙ„ÙŠ Ø²ÙƒÙŠØ©", "Ø§Ù„ÙŠØ­ÙŠØ§ÙˆÙŠ Ù…Ù„Ø§Ùƒ", "Ø¹Ø¨Ùˆ Ø£Ø¯Ù…", "Ø§Ù„Ø¯Ø§ÙˆØ¯ÙŠ ÙŠÙ…ÙŠÙ†Ø©", "Ø§Ù„Ø¹ÙŠØ·Ø§ ÙØ±Ø¯ÙˆØ³", "Ø³Ø§Ù„Ù… Ø³ÙÙŠØ§Ù†", "Ø±ÙŠØ¨Ø§Ùƒ Ù…Ø±ÙŠÙ…", "Ø§Ø¹Ø±Ø§Ø¨ Ø¯Ø§ÙˆØ¯", "Ø­Ù…Ø§Ø¯ØªÙŠ Ø¹ÙŠØ³Ù‰", "Ø¨Ù„ÙˆØ· Ø´ÙŠÙ…Ø§Ø¡", "Ø§Ø´Ø¸Ø§Ù† ÙØ§Ø·Ù…Ø©", "Ù…Ù‚Ø±Ø§Ù†ÙŠ ÙØ§Ø·Ù…Ø©", "Ø­Ù„Ø­ÙˆÙ„ ÙˆØµØ§Ù„", "Ù…Ø¹Ø²ÙˆØ²ÙŠ Ù‡Ø¨Ø©", "Ø§Ù„Ø¯Ø±Ù‚Ø§ÙˆÙŠ Ø§Ø³Ù…Ø§Ø¹ÙŠÙ„", "Ø¹Ø³Ùˆ Ø²ÙƒÙŠØ©", "Ø§Ù„ÙˆÙƒÙŠÙ„ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯"];

    const LISTES_2APIC = {
        "2APIC-1": ELEVES_2APIC_1,
        "2APIC-2": ELEVES_2APIC_2,
        "2APIC-3": ELEVES_2APIC_3
    };

    // --- LOGIQUE D'AFFICHAGE DES Ã‰LÃˆVES ---
    document.getElementById('classe').addEventListener('change', function () {
        const classe = this.value;
        const box = document.getElementById('listeElevesBox');
        
        if (!classe || !LISTES_2APIC[classe]) {
            box.innerHTML = "<em>Veuillez choisir une classe valide (2APIC-1 Ã  3) pour afficher les Ã©lÃ¨ves...</em>";
            return;
        }
        
        const liste = LISTES_2APIC[classe];
        const count = liste.length;
        const COLS = 6;
        const rows = Math.ceil(count / COLS);
        
        let html = `<div class="eleve-title">Nombre d'Ã©lÃ¨ves : ${count}</div>`;
        html += `<table class="eleve-table"><tbody>`;
        
        for (let r = 0; r < rows; r++) {
            html += "<tr>";
            for (let c = 0; c < COLS; c++) {
                const index = r * COLS + c;
                html += index < count ? `<td>${index + 1}. ${liste[index]}</td>` : "<td></td>";
            }
            html += "</tr>";
        }
        html += "</tbody></table>";
        box.innerHTML = html;
    });

    // --- LOGIQUE EXERCICE ---
    const correctAnswers = {
        q1: 'a', q2: 'b', q3: 'b', q4: 'a', q5: 'a',
        q6: 'a', q7: 'a', q8: 'a', q9: 'a', q10: 'a',
        q11: 'a', q12: 'a', q13: 'b', q14: 'c', q15: 'a'
    };

    let resultatEnvoye = false;
    let impressionFaite = false;

    function verifierReponses() {
        if (resultatEnvoye) {
            alert("Devoir dÃ©jÃ  soumis.");
            return;
        }

        const nom = document.getElementById('nomComplet').value.trim();
        const classe = document.getElementById('classe').value;
        const groupe = document.getElementById('groupe').value;

        // 1. Validation Nom / Classe
        if (!nom || !classe || !groupe) {
            showError("Veuillez remplir tous les champs (Nom, Classe, Groupe).");
            return;
        }

        // VÃ©rification anti-triche
        if (LISTES_2APIC[classe]) {
            const liste = LISTES_2APIC[classe];
            const found = liste.some(eleve => eleve.trim() === nom);
            if (!found) {
                alert("âš ï¸ Erreur : Votre nom ne figure pas dans la liste officielle de la classe " + classe + ".\nVÃ©rifiez l'orthographe exacte dans le tableau.");
                return;
            }
        }

        // 2. Correction
        let score = 0;
        const pointsPerQuestion = 20 / 15; // ~1.33 pts par question

        for (let q in correctAnswers) {
            const selected = document.querySelector(`input[name="${q}"]:checked`);
            const feedbackEl = document.getElementById(`feedback-${q}`);
            
            if (selected) {
                const isCorrect = selected.value === correctAnswers[q];
                if (isCorrect) score += pointsPerQuestion;
                
                feedbackEl.textContent = isCorrect ? 'âœ“ Correct' : 'âœ— Incorrect';
                feedbackEl.className = `feedback show ${isCorrect ? 'correct' : 'incorrect'}`;
                selected.closest('.option').classList.add(isCorrect ? 'correct' : 'incorrect');
            } else {
                feedbackEl.textContent = 'âœ— Non rÃ©pondu';
                feedbackEl.className = 'feedback show incorrect';
            }
        }

        // 3. Affichage RÃ©sultats
        const noteFinale = Math.round(score * 10) / 10; // Arrondi 1 dÃ©cimale
        document.getElementById('noteValue').textContent = noteFinale;
        
        let appreciation = "", color = "";
        if (noteFinale >= 18) { appreciation = "Excellent (A)"; color = "#d4edda"; }
        else if (noteFinale >= 15) { appreciation = "TrÃ¨s Bien (B)"; color = "#c3e6cb"; }
        else if (noteFinale >= 12) { appreciation = "Bien (C)"; color = "#fff3cd"; }
        else if (noteFinale >= 10) { appreciation = "Passable (D)"; color = "#ffeeba"; }
        else { appreciation = "Insuffisant (F)"; color = "#f8d7da"; }

        const appBox = document.getElementById('appreciationBox');
        appBox.textContent = appreciation;
        appBox.style.backgroundColor = color;
        
        document.getElementById('scoreSummary').classList.add('show');
        document.getElementById('printBtn').style.display = 'inline-block';

        // 4. Verrouillage et Envoi
        resultatEnvoye = true;
        const btnVerif = document.querySelector('.btn-primary');
        btnVerif.disabled = true;
        btnVerif.textContent = "Devoir soumis";
        btnVerif.style.opacity = "0.6";

        // Envoi Google Sheets (GET)
        envoyerResultatGoogle(nom, classe, groupe, noteFinale);

        // Sauvegarde HTML (POST)
        document.getElementById('save_nom').value = nom;
        document.getElementById('save_classe').value = classe;
        document.getElementById('save_html').value = document.documentElement.outerHTML;
        document.getElementById('saveFormDevoir').submit();

        // GÃ©nÃ©ration PDF Automatique
        genererPDFDevoir(nom, classe);
    }

    function envoyerResultatGoogle(nom, classe, groupe, note) {
        // Remplacez cette URL par votre vÃ©ritable Script ID si nÃ©cessaire
        const scriptUrl = "https://script.google.com/macros/s/AKfycbx0OcYdDps_-tf4yYVhAcy611dQl0rAUYkeYt6UyWU4Q96sOQdlVk87aPB3K6txrRkPtA/exec";
        
        const params = new URLSearchParams({
            nom: nom,
            classe: classe,
            groupe: groupe,
            note: String(note)
        });

        fetch(scriptUrl + "?" + params.toString(), {
            method: "GET",
            mode: "no-cors"
        }).catch(e => console.error("Erreur envoi sheet:", e));
    }

    function genererPDFDevoir(nom, classe) {
        const element = document.querySelector('.container');
        const opt = {
            margin: 5,
            filename: `Devoir_Reseau - ${classe} - ${nom}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        impressionFaite = true;
        html2pdf().from(element).set(opt).save();
    }

    function imprimerDevoir() {
        const nom = document.getElementById('nomComplet').value || "Eleve";
        const classe = document.getElementById('classe').value || "Classe";
        genererPDFDevoir(nom, classe);
    }

    function reinitialiser() {
        if (resultatEnvoye && !impressionFaite) {
            alert("Veuillez d'abord tÃ©lÃ©charger/imprimer le PDF.");
            return;
        }
        
        // Reset Visuel
        document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
        document.querySelectorAll('.option').forEach(o => o.classList.remove('correct', 'incorrect'));
        document.querySelectorAll('.feedback').forEach(f => { f.textContent = ''; f.classList.remove('show'); });
        document.getElementById('scoreSummary').classList.remove('show');
        document.getElementById('printBtn').style.display = 'none';
        
        // Reset Logique
        resultatEnvoye = false;
        impressionFaite = false;
        
        const btnVerif = document.querySelector('.btn-primary');
        btnVerif.disabled = false;
        btnVerif.textContent = "âœ“ VÃ©rifier et Envoyer";
        btnVerif.style.opacity = "1";
    }

    function showError(msg) {
        const alertBox = document.getElementById('warningAlert');
        alertBox.textContent = "âš ï¸ " + msg;
        alertBox.classList.add('show');
        setTimeout(() => alertBox.classList.remove('show'), 4000);
    }
</script>

</body>
</html>
